# SchedulerAPI

–†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á –Ω–∞ Go —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PostgreSQL –∏ NATS JetStream.

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã—Ö –∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á
- **–†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ NATS JetStream –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–¥–∞—á –º–µ–∂–¥—É –≤–æ—Ä–∫–µ—Ä–∞–º–∏
- **REST API**: –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π HTTP API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏
- **Graceful Shutdown**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã
- **Structured Logging**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é zap
- **Docker Support**: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Docker –∏ docker-compose

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Go 1.24.3+
- Docker –∏ Docker Compose
- PostgreSQL 15+
- NATS 2.12+
- Make

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/1KrAiDoN1/SchedulerAPI.git
cd SchedulerAPI
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`


### 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –°–æ–±—Ä–∞—Ç—å Docker –æ–±—Ä–∞–∑—ã
make docker-build

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã (PostgreSQL, NATS, Scheduler, Worker)
make docker-up

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
make migrate-up
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
make docker-ps

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
make docker-logs

```

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è



### Jobs API

#### –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É

```bash
# –°–æ–∑–¥–∞—Ç—å –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—É—é –∑–∞–¥–∞—á—É
POST /api/v1/jobs
Content-Type: application/json

{
  "once": "2025-11-15T15:04:05Z",
  "payload": {
    "type": "email",
    "recipient": "user@example.com"
  }
}

# –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –∑–∞–¥–∞—á—É
POST /api/v1/jobs
Content-Type: application/json

{
  "interval": "5m",
  "payload": {
    "type": "backup",
    "target": "database"
  }
}
```

#### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏

```bash
GET /api/v1/jobs
```

#### –ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á—É –ø–æ ID

```bash
GET /api/v1/jobs/{job_id}
```

#### –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É

```bash
DELETE /api/v1/jobs/{job_id}
```

#### –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π –∑–∞–¥–∞—á–∏

```bash
GET /api/v1/jobs/{job_id}/executions
```

## üîß Makefile –∫–æ–º–∞–Ω–¥—ã

### Docker –∫–æ–º–∞–Ω–¥—ã

```bash
make docker-build          # –°–æ–±—Ä–∞—Ç—å Docker –æ–±—Ä–∞–∑—ã
make docker-up             # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
make docker-down           # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
make docker-restart        # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
make docker-stop           # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã (–±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è)
make docker-start          # –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
make docker-ps             # –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
make docker-logs           # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
make docker-logs-scheduler # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
make docker-logs-worker    # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –≤–æ—Ä–∫–µ—Ä–∞
make docker-logs-db        # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
make docker-logs-nats      # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ NATS
```

### –ö–æ–º–∞–Ω–¥—ã –º–∏–≥—Ä–∞—Ü–∏–π

```bash
make migrate-up      # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
make migrate-down    # –û—Ç–∫–∞—Ç–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
make migrate-status  # –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π (—Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü)
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ cmd/scheduler/          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
‚îú‚îÄ‚îÄ worker/                 # Worker —Å–µ—Ä–≤–∏—Å
‚îÇ   ‚îú‚îÄ‚îÄ cmd/worker/        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤–æ—Ä–∫–µ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ internal/          # –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–¥ –≤–æ—Ä–∫–µ—Ä–∞
‚îú‚îÄ‚îÄ internal/              # –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∫–æ–¥ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ app/              # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ config/           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ domain/           # –î–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ http-server/      # HTTP —Å–µ—Ä–≤–µ—Ä –∏ handlers
‚îÇ   ‚îú‚îÄ‚îÄ repositories/     # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (DB, NATS)
‚îÇ   ‚îî‚îÄ‚îÄ services/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ migrations/           # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ docker-compose.yaml   # Docker compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile           # Docker –æ–±—Ä–∞–∑
‚îî‚îÄ‚îÄ Makefile            # –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥
```